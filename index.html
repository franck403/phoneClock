<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Clock - By Geoloup</title>
<link rel="shortcut icon" href="clock.png">
<link rel="manifest" href="manifest.json" />
<link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>
<link rel="stylesheet" href="style.css">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0,interactive-widget=resizes-content">
<style id="webmakerstyle">
body {
  background-color: black;
  font-family: Arial, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  color:darkgray;
  height:100vh;
  overflow:hidden;
  flex-direction:column;
}

#clock {
  font-size: 15vw;
  text-align: center;
}

.seconds {
  color:#454545;
}
#date {
  font-size:1.5em;
}
  video {
    position:fixed;opacity: 0;
  user-select: none;
  }
</style>
</head>
<body>
<video id='video' width="320" height="240" autoplay loop muted>
  <source src="screen.mp4" type="video/mp4" />
</video>

<label><input id='lock' type="checkbox" value="keep screen alive"> keep screen alive</label>
<div class="weather-container">
    <div>
        <h2>Weather Information</h2>
        <i class="bx bxs-sun" id="weather-icon"></i>
    </div>
    <div id="today-weather">
        
        <h3>Aujourd'hui:</h3><div id="temperature">Temperature: 16.1Â°C</div>
        <div id="uv-index">UV Index: 5.1</div>
    </div>
    <div id="tomorrow-weather">
        <h3>Demain</h3>
        <div id="tomorrow-temp">Tomorrow's Temperature: 24.7Â°C</div>
        <div id="tomorrow-uv">Tomorrow's UV Index: 6.1</div>
    </div>
</div>
<div id="clock"></div>
<div id="date"></div>
<h3 id='batterie'></h3>
<div id='hourly-uv-index'></div>
<script>
  var screenLock;
function updateClock() {
    var now = new Date();
    var hours = now.getHours();
    var minutes = now.getMinutes();
    var seconds = now.getSeconds();

    // Add leading zeros if necessary
    hours = (hours < 10) ? "0" + hours : hours;
    minutes = (minutes < 10) ? "0" + minutes : minutes;
    seconds = (seconds < 10) ? "0" + seconds : seconds;

    var time = hours + ":" + minutes + ":<span class='seconds'>" + seconds + '</span>';

    document.getElementById('clock').innerHTML = time;
    var date = frenchGreeting()
    document.getElementById('date').innerHTML = date;
    
}

// Update the clock every second
setInterval(updateClock, 1000);

// Update the clock immediately to avoid delay
updateClock();

function frenchGreeting() {
    let date = new Date();
    let hours = date.getHours();
    let months = ["janvier", "fÃ©vrier", "mars", "avril", "mai", "juin", "juillet", "aoÃ»t", "septembre", "octobre", "novembre", "dÃ©cembre"];
    let day = date.getDate();
    let month = months[date.getMonth()];
    let year = date.getFullYear();

    if (hours < 12) {
        return "Bonjour! Nous sommes en " + month + " le " + day + " " + year + ".";
    } else if (hours < 18) {
        return "Bon aprÃ¨s-midi! Nous sommes en " + month + " le " + day + " " + year + ".";
    } else {
        return "Bonne soirÃ©e! Nous sommes en " + month + " le " + day + " " + year + ".";
    }
}
  async function getScreenLock() {
  if(isScreenLockSupported()) {
    try {
       screenLock = await navigator.wakeLock.request();
    } catch(err) {
       console.log(err.name, err.message);
    }
    return screenLock;
  }
}
function release() { 
  if(typeof screenLock !== "undeinfed" && screenLock != null) {
    screenLock.release()
    .then(() => {
      console.log("Lock released ðŸŽˆ");
      screenLock = null;
    });
  }
}
  document.addEventListener('visibilitychange', async () => {
  if (screenLock !== null && document.visibilityState === 'visible') {
    screenLock = await navigator.wakeLock.request('screen');
  }
});
  function toggleLock() {
    var val = document.getElementById('lock').checked
    if (val) {
      document.getElementById('video').play()
      getScreenLock()
    } else {
      release()
      document.getElementById('video').pause()
    }
  }
    document.getElementById('video').pause()
    const latitude = 51.5074;
    const longitude = -0.1278;

const weatherIcons = {
    0: 'bx-sun',
    1: 'bx-sun',
    2: 'bx-cloud',
    3: 'bx-cloud',
    45: 'bx-cloud',
    48: 'bx-cloud',
    51: 'bx-rain',
    53: 'bx-rain',
    55: 'bx-rain',
    56: 'bx-rain',
    57: 'bx-rain',
    61: 'bx-rain',
    63: 'bx-rain',
    65: 'bx-rain',
    66: 'bx-rain',
    67: 'bx-rain',
    71: 'bx-cloud-snow',
    73: 'bx-cloud-snow',
    75: 'bx-cloud-snow',
    77: 'bx-cloud-snow',
    80: 'bx-cloud-rain',
    81: 'bx-cloud-rain',
    82: 'bx-cloud-rain',
    85: 'bx-cloud-rain',
    86: 'bx-cloud-rain',
    95: 'bx-cloud-lightning',
    96: 'bx-cloud-lightning',
    99: 'bx-cloud-lightning'
};
async function getWeatherData() {
    const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&hourly=uv_index&daily=temperature_2m_max,uv_index_max,weathercode&current_weather=true&timezone=auto`);
    const data = await response.json();
    return data;
}

function displayHourlyUVIndex(data) {
    const hourlyUVIndexContainer = document.getElementById('hourly-uv-index');
    hourlyUVIndexContainer.innerHTML = '';

    data.hourly.time.slice(0, 24).forEach((time, index) => {
        const uvIndex = data.hourly.uv_index[index];
        const date = new Date(time * 1000);
        const hour = date.getHours().toString().padStart(2, '0');

        const listItem = document.createElement('li');
        listItem.innerText = `${hour}:00 - UV Index: ${uvIndex}`;
        hourlyUVIndexContainer.appendChild(listItem);
    });
}

function displayWeatherData(data) {
    displayHourlyUVIndex(data)
    const currentWeatherCode = data.current_weather.weathercode;
    const currentWeatherIcon = weatherIcons[currentWeatherCode] || 'bx-cloud';

    document.getElementById('weather-icon').className = `bx ${currentWeatherIcon}`
    document.getElementById('temperature').innerText = `TempÃ©rature: ${data.current_weather.temperature}Â°C`;
    document.getElementById('uv-index').innerText = `UV max: ${data.daily.uv_index_max[0]}`;
    document.getElementById('tomorrow-temp').innerText = `TenpÃ©rature Demain: ${data.daily.temperature_2m_max[1]}Â°C`;
    document.getElementById('tomorrow-uv').innerText = `UV max de Demain: ${data.daily.uv_index_max[1]}`;
}

getWeatherData()
    .then(data => displayWeatherData(data))
    .catch(error => console.error(error));
setInterval(()=> {},1000*60*60) // repeat every 60 minutes work my 1000ms * 60s to make 1 minute then *60 minute to make 1h
  var batterie = document.getElementById('batterie')
navigator.getBattery().then((battery) => {
  function updateAllBatteryInfo() {
    updateChargeInfo();
    updateLevelInfo();
    updateChargingInfo();
    updateDischargingInfo();
  }
  updateAllBatteryInfo();
  battery.addEventListener("chargingchange", () => {
    updateChargeInfo();
  });
  function updateChargeInfo() {
    batterie.innerText("Battery en charge ? " + (battery.charging ? "Oui" : "Non"));
  }

  battery.addEventListener("levelchange", () => {
    updateLevelInfo();
  });
  function updateLevelInfo() {
    batterie.innerText("Niveau de batterie : " + battery.level * 100 + "%");
  }

  battery.addEventListener("chargingtimechange", () => {
    updateChargingInfo();
  });
  function updateChargingInfo() {
    batterie.innerText(
      "Temps avant charge de la batterie : " +
        battery.chargingTime +
        " secondes",
    );
  }

  battery.addEventListener("dischargingtimechange", () => {
    updateDischargingInfo();
  });
  function updateDischargingInfo() {
    console.log(
      "Autonomie sur batterie : " + battery.dischargingTime + " secondes",
    );
  }
});

</script>
</body>
</html>
